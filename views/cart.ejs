<!DOCTYPE html>
<html>

<head>
  <title>Your Cart</title>
  <link href="/stylesheets/menu.css" rel="stylesheet" />
  <!-- Bootstrap 5 CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
  <nav class="navbar navbar-expand-lg">
    <div class="container-fluid px-4">
      <!-- Logo -->
      <a class="navbar-brand" href="/">
        <img
          src="https://plus.unsplash.com/premium_photo-1661914978519-52a11fe159a7?w=600&auto=format&fit=crop&q=60&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxzZWFyY2h8MXx8bG9nb3xlbnwwfHwwfHx8MA%3D%3D"
          alt="Logo" class="logo">
      </a>
      <!-- Cart Button -->

    </div>
  </nav>

  <div class="container py-5">
    <h1 class="mb-4">Your Cart</h1>

    <% if (cartItems && cartItems.length> 0) {

      let total = 0;
      cartItems.forEach(item => total += item.menuprice * item.quantity);
      %>
      <% let totalQty=0; cartItems.forEach(item=> totalQty += item.quantity);
        %>

        <div class="row">
          <!-- üõí Cart Items - Left Column -->
          <div class="col-md-8">
            <div class="row row-cols-1 row-cols-sm-2 row-cols-md-2 g-4">
              <% cartItems.forEach(function(item) { %>
                <div class="col">
                  <div class="card h-100">
                    <img src="/images/uploads/<%= item.menuimage %>" onerror="this.src='/images/placeholder.jpg'"
                      class="card-img-top" alt="<%= item.menuname %>" style="height: 200px; object-fit: cover;">
                    <div class="card-body">
                      <h5 class="card-title">
                        <%= item.menuname %>
                      </h5>
                      <p class="text-muted"><strong>Category:</strong>
                        <%= item.menucategory %>
                      </p>
                      <p>
                        <%= item.menudescription %>
                      </p>
                      <p class="fw-bold text-success">$<%= item.menuprice %>
                      </p>
                      <div class="d-flex align-items-center gap-2 mt-3">
                        <form action="/cart/decrease/<%= item._id %>" method="POST">
                          <button class="btn btn-outline-secondary btn-sm">‚àí</button>
                        </form>

                        <span><strong>Qty:</strong>
                          <%= item.quantity %>
                        </span>

                        <form action="/cart/add/<%= item._id %>" method="POST">
                          <input type="hidden" name="quantity" value="1">
                          <button class="btn btn-outline-secondary btn-sm">+</button>
                        </form>
                      </div>

                      <form action="/cart/remove/<%= item._id %>" method="POST" class="d-flex gap-2 mt-auto"
                        style="min-width: 60px;">
                        <button class="btn btn-danger w-100" type="submit">‚ùå Remove</button>
                      </form>
                    </div>
                  </div>
                </div>
                <% }) %>
            </div>
          </div>

          <!-- üíµ Billing Summary - Right Column -->
          <div class="col-md-4">
            <div class="card shadow-sm p-4">
              <h4>Billing Summary</h4>
              <hr>
              <p><strong>Items:</strong>
                <%= totalQty %>
              </p>
              <p><strong>Total Price:</strong> $<%= total.toFixed(2) %>
              </p>
              <p><strong>Tax (10%):</strong> $<%= (total * 0.10).toFixed(2) %>
              </p>
              <p class="fw-bold"><strong>Grand Total:</strong> $<%= (total * 1.10).toFixed(2) %>
              </p>
              <button class="btn btn-success w-100 mt-3">Proceed to Checkout</button>
            </div>
          </div>
        </div>

        <% } else { %>
          <!-- Empty Cart View -->
          <div class="text-center py-5">
            <h2 class="text-secondary">Your cart is empty</h2>
            <a href="/" class="btn btn-outline-primary mt-3">Back to Menu</a>
          </div>
          <% } %>
  </div>

</body>

</html>